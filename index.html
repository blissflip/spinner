<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <title>BlissFlip ¿</title>

  <style>
    :root{
      --bg-img: url("Copilot_20250819_075823.png");
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
    }

    html, body { height: 100%; }
    body{
      margin:0;
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      overflow-x: hidden;
      background:
        radial-gradient(1200px 600px at 50% 45%, rgba(0,0,0,.10), rgba(0,0,0,.75)),
        var(--bg-img) center/cover no-repeat fixed;
    }

    .vignette{
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(900px 500px at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.38) 55%, rgba(0,0,0,.70) 100%),
        linear-gradient(to bottom, rgba(0,0,0,.15), rgba(0,0,0,.55));
      mix-blend-mode: multiply;
    }

    .wrap{
      min-height: 100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 28px 18px;
    }

    .stage{
      width: min(980px, 100%);
      display:flex;
      flex-direction: column;
      align-items:center;
      gap: 16px;
    }

    .headline{
      text-align:center;
      line-height: 1.1;
      letter-spacing: .02em;
      font-size: clamp(22px, 2.6vw, 34px);
      text-shadow: 0 10px 30px rgba(0,0,0,.55);
      margin: 0;
    }

    .sub{
      margin: 0;
      text-align:center;
      max-width: 60ch;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
      text-shadow: 0 10px 30px rgba(0,0,0,.55);
    }

    /* ===== Portal (mobile-proof circle) =====
       We DO NOT rely on aspect-ratio.
       We force equal width + height to avoid “circle in a square” on mobile.
    */
    .portal{
      --size: min(520px, 92vw);
      position: relative;
      width: var(--size);
      height: var(--size);
      border-radius: 50%;
      display:grid;
      place-items:center;
      background: radial-gradient(circle at 50% 40%, rgba(255,255,255,.10), rgba(0,0,0,.35));
      box-shadow:
        0 20px 90px rgba(0,0,0,.55),
        inset 0 0 0 1px rgba(255,255,255,.12);
      overflow:hidden;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }

    .portal::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        conic-gradient(from 180deg,
          rgba(120,255,220,0.00),
          rgba(140,220,255,0.22),
          rgba(255,255,255,0.08),
          rgba(120,255,220,0.14),
          rgba(140,220,255,0.00));
      filter: blur(8px);
      opacity: .9;
      animation: drift 7.5s linear infinite;
      transform-origin: center;
    }

    @keyframes drift{
      0%   { transform: rotate(0deg) scale(1.06); }
      100% { transform: rotate(360deg) scale(1.06); }
    }

    .ring{
      position:absolute;
      inset: 14px;
      border-radius: 50%;
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.14),
        inset 0 0 45px rgba(140,220,255,.14),
        0 0 55px rgba(120,255,220,.10);
      pointer-events:none;
    }

    .core{
      position: relative;
      width: 72%;
      height: 72%;
      border-radius: 50%;
      background: radial-gradient(circle at 50% 40%, rgba(255,255,255,.10), rgba(0,0,0,.55));
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.12),
        inset 0 0 80px rgba(0,0,0,.65);
      display:grid;
      place-items:center;
      text-align:center;
      padding: 18px;
      z-index: 2;
    }

    /* The oracle tap target (big ¿) */
    .oracle{
      appearance: none;
      border: none;
      background: transparent;
      color: rgba(255,255,255,.93);
      cursor: pointer;
      display: grid;
      place-items: center;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      -webkit-tap-highlight-color: transparent;
      position: relative;
    }

    .oracle:focus{ outline: none; }
    .oracle:focus-visible{
      box-shadow: 0 0 0 3px rgba(255,255,255,.18), 0 0 0 10px rgba(140,220,255,.10);
    }

    .qmark{
      font-size: clamp(92px, 12vw, 140px);
      line-height: 1;
      letter-spacing: .02em;
      text-shadow:
        0 18px 60px rgba(0,0,0,.65),
        0 0 35px rgba(140,220,255,.18);
      transform: translateY(-2px);
      opacity: .96;
    }

    .hint{
      margin-top: 10px;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.45;
      text-shadow: 0 10px 30px rgba(0,0,0,.55);
    }

    /* subtle “breath” pulse on the mark only (not cheesy) */
    @keyframes breathe{
      0%   { transform: translateY(-2px) scale(1.0); opacity: .92; }
      50%  { transform: translateY(-2px) scale(1.02); opacity: .98; }
      100% { transform: translateY(-2px) scale(1.0); opacity: .92; }
    }
    .oracle:not(:active) .qmark{
      animation: breathe 4.6s ease-in-out infinite;
    }

    .status{
      margin: 0;
      min-height: 20px;
      text-align:center;
      font-size: 13px;
      color: var(--muted);
      opacity: .95;
      text-shadow: 0 10px 30px rgba(0,0,0,.55);
    }

    /* ===== Overlays (mobile-safe, no popups) ===== */
    .bfOverlay{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 99999;
      background: rgba(0,0,0,0.92);
    }
    .bfOverlay.isOpen{ display:block; }

    .bfBar{
      position:absolute; top:0; left:0; right:0;
      height:56px;
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px; gap:10px;
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .bfTitle{
      font-size:14px;
      opacity:0.85;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:55vw;
    }

    .bfBtn{
      appearance:none;
      border:1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      color: rgba(255,255,255,0.92);
      padding:8px 10px;
      border-radius:10px;
      cursor:pointer;
    }

    .bfFrame{
      position:absolute;
      top:56px; left:0; right:0; bottom:0;
      width:100%;
      height:calc(100% - 56px);
      border:0;
      background:#000;
    }

    .whisperWrap{
      position:absolute;
      top:56px; left:0; right:0; bottom:0;
      display:grid;
      place-items:center;
      padding:26px;
    }

    .whisperText{
      max-width:65ch;
      font-size: clamp(18px, 2.2vw, 26px);
      line-height:1.55;
      text-align:center;
      color: rgba(255,255,255,.92);
      text-shadow: 0 12px 40px rgba(0,0,0,.65);
    }

    .footer{
      margin-top: 6px;
      font-size: 12px;
      color: rgba(255,255,255,.55);
      text-align:center;
      letter-spacing: .02em;
    }
  </style>
</head>

<body>
  <div class="vignette"></div>

  <div class="wrap">
    <main class="stage">
      <h1 class="headline">BlissFlip ¿</h1>
      <p class="sub">For a star-child, home is closer than you think.</p>

      <section class="portal" aria-label="BlissFlip portal">
        <div class="ring"></div>

        <div class="core">
          <button id="oracleTap" class="oracle" type="button" aria-label="BlissFlip oracle">
            <div>
              <div class="qmark">¿</div>
              <div class="hint">Tap once. Let the moment choose.</div>
            </div>
          </button>
        </div>
      </section>

      <p id="status" class="status"></p>

      <div class="footer">yinyangi</div>
    </main>
  </div>

  <!-- i-Experiencer overlay -->
  <div id="bfOverlay" class="bfOverlay" aria-hidden="true">
    <div class="bfBar">
      <button id="bfBack" class="bfBtn" type="button">← Return</button>
      <div class="bfTitle" id="bfTitle">i-Experiencer</div>
      <button id="bfClose" class="bfBtn" type="button">✕</button>
    </div>

    <iframe
      id="bfFrame"
      class="bfFrame"
      src="about:blank"
      allow="autoplay; fullscreen; picture-in-picture"
      allowfullscreen
      loading="eager"
      referrerpolicy="no-referrer-when-downgrade"
    ></iframe>
  </div>

  <!-- Whisper overlay -->
  <div id="whisperOverlay" class="bfOverlay" aria-hidden="true">
    <div class="bfBar">
      <button id="whisperBack" class="bfBtn" type="button">← Return</button>
      <div class="bfTitle">Whisper</div>
      <button id="whisperClose" class="bfBtn" type="button">✕</button>
    </div>
    <div class="whisperWrap">
      <div id="whisperText" class="whisperText"></div>
    </div>
  </div>

  <script>
    // Your Bunny i-Experiencer URLs
    const EXPERIENCES = [
      "https://iframe.mediadelivery.net/play/477963/58e76783-cdd1-45f3-aca7-5df5661f674f?1768965668074",
      "https://iframe.mediadelivery.net/play/478159/33499ff2-e71e-4522-bcbe-2206a14752ed?1768965668074"
      // ...add more
    ];

    // Whisper lines
    const WHISPERS = [
      "Breathe. The door is already open.",
      "Choose nothing. Let it arrive.",
      "What you seek is seeking you.",
      "Home isn’t far — it’s near enough to feel.",
      "The next step is gentleness."
    ];

    const oracleTap = document.getElementById("oracleTap");
    const statusEl  = document.getElementById("status");

    // i-Experiencer overlay
    const bfOverlay = document.getElementById("bfOverlay");
    const bfFrame   = document.getElementById("bfFrame");
    const bfBack    = document.getElementById("bfBack");
    const bfClose   = document.getElementById("bfClose");
    const bfTitle   = document.getElementById("bfTitle");

    // Whisper overlay
    const whisperOverlay = document.getElementById("whisperOverlay");
    const whisperText    = document.getElementById("whisperText");
    const whisperBack    = document.getElementById("whisperBack");
    const whisperClose   = document.getElementById("whisperClose");

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function lockScroll(){
      document.documentElement.style.overflow = "hidden";
      document.body.style.overflow = "hidden";
    }

    function unlockScroll(){
      document.documentElement.style.overflow = "";
      document.body.style.overflow = "";
    }

    function openExperience(url, title){
      bfTitle.textContent = title || "i-Experiencer";
      bfFrame.src = url;
      bfOverlay.classList.add("isOpen");
      bfOverlay.setAttribute("aria-hidden","false");
      lockScroll();
    }

    function closeExperience(){
      bfOverlay.classList.remove("isOpen");
      bfOverlay.setAttribute("aria-hidden","true");
      bfFrame.src = "about:blank";
      unlockScroll();
      statusEl.textContent = "";
    }

    function openWhisper(msg){
      whisperText.textContent = msg;
      whisperOverlay.classList.add("isOpen");
      whisperOverlay.setAttribute("aria-hidden","false");
      lockScroll();
    }

    function closeWhisper(){
      whisperOverlay.classList.remove("isOpen");
      whisperOverlay.setAttribute("aria-hidden","true");
      unlockScroll();
      statusEl.textContent = "";
    }

    bfBack.addEventListener("click", closeExperience);
    bfClose.addEventListener("click", closeExperience);
    whisperBack.addEventListener("click", closeWhisper);
    whisperClose.addEventListener("click", closeWhisper);

    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape"){
        closeExperience();
        closeWhisper();
      }
    });

    // One-tap oracle: sometimes whisper, sometimes i-Experiencer
    oracleTap.addEventListener("click", () => {
      statusEl.textContent = "…";

      const whisperFirst = (Math.random() < 0.35); // adjust ratio if you like

      if (whisperFirst){
        openWhisper(pickRandom(WHISPERS));
        return;
      }

      if (!EXPERIENCES.length){
        statusEl.textContent = "No experiences configured yet.";
        return;
      }

      openExperience(pickRandom(EXPERIENCES), "i-Experiencer");
    });
  </script>
</body>
</html>
